<div class="container">
  <div class="header">
    <h1>üåü Explorez les Activit√©s</h1>
  </div>
  <div class="search-bar">
    <button
      *ngIf="!isTravelActivityMode; else backButton"
      (click)="onAdd()"
      class="btn btn-primary">
      Ajouter une activit√©
    </button>

    <ng-template #backButton>
      <button (click)="goBack()" class="btn btn-secondary" >
        <i class="fas fa-arrow-left"></i>
        Retour
      </button>
    </ng-template>
    <input type="text"
           placeholder="Rechercher une activit√©..."
           [(ngModel)]="filterText"
           class="search-input" />
  </div>


  <div class="activities-grid"
       [class.single-item]="filteredActivities().length === 1"
       *ngIf="filteredActivities().length > 0">
    <div class="activity-card"
         *ngFor="let activity of filteredActivities()"
         tabindex="0"
         >

      <div class="activity-header">
        <div class="activity-name">{{ activity.name }}</div>
        <div class="activity-category">{{ activity.categoryName }}</div>
      </div>

      <p class="activity-description">
        {{ activity.description || 'Pas de description disponible.' }}
      </p>

      <div class="activity-details">
        <div class="detail-item">
          <div class="detail-icon">üìç</div>
          <div class="detail-text">{{ activity.address }}, {{ activity.city }}</div>
        </div>
        <div class="detail-item">
          <div class="detail-icon">üåç</div>
          <div class="detail-text">{{ activity.country }}</div>
        </div>
      </div>

      <div class="activity-footer">
        <div class="activity-price">{{ activity.gross_price }}‚Ç¨</div>
        <div class="activity-actions">

          @if(isTravelActivityMode){
            <button class="btn btn-primary" (click)="AddActivityCustomer(activity.id)">
              ‚ú® R√©server
            </button>
          } @else {
            <button class="btn btn-primary" (click)="onEdit(activity.id)">
              Modifier
            </button>
          }
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="isTravelActivityMode && groupeId && OnSelectedActivity" class="overlay">
    <div class="popup">
      <label for="datePicker">Choisir une date entre {{startDate}} et {{endDate}}</label>
      <input
        id="datePicker"
        type="date"
        [min]="startDate"
        [max]="endDate"
        (change)="onDateChange($event)"
      />

      <div *ngIf="errorMessage()" class="error-message">
        {{ errorMessage() }}
      </div>

      <div class="popup-buttons">
        <button class="btn btn-secondary" (click)="OnSelectedActivity=false">Annuler</button>
        <button class="btn btn-primary" (click)="confirmDate()" [disabled]="!selectedDate()">Confirmer</button>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="filteredActivities().length === 0">
    <h2>üîç Aucune activit√© trouv√©e</h2>
    <p>Essayez d‚Äô√©largir vos crit√®res de recherche.</p>
  </div>
</div>
